# 파일 시스템 라이브러리

- C++17부터 추가된 파일 시스템 라이브러리는 `boost::filesystem`을 토대로 만든 것이다.
- 이 라이브러리는 파일, 파일 이름, 경로라는 세 가지 개념을 토대로 구성된다.
  - `파일` : 데이터를 저장하는 개체, 원하는 내용을 파일에 쓰거나 그 안에 담긴 내용을 읽을 수 있으며 파일마다 이름과 타입이 있다. 파일 타입으로는 디렉터리, 하드 링크, 심볼릭 링크, 일반 파일 등이 있다.
    - `디렉터리` : 파일을 담는 컨테이너. 현재 디렉터리는 점(.)으로 표기하고, 부모 디렉터리는 점 두개(..)로 표기한다.
    - `하드 링크` : 기존 파일에 연결된 이름
    - `심볼릭 링크` : 파일에 대한 경로에 이름을 연결한 것. 해당 경로가 존재하지 않을 수도 있다.
    - `일반 파일` : 디렉터리나 하드 링크나 심볼릭 링크가 아닌 디렉터리에 들어갈 항목
  - `파일 이름` : 파일을 가리키는 스트링. 파일 이름에 사용할 수 있는 문자의 종류나 이름의 길이, 대소문자 구분 여부 등은 구현마다 다르다.
  - `경로` : 파일의 위치를 가리키는 요소로 나열한 것. 옵션으로 루트 이름이나 루트 디렉터리가 붙을 수 있다. 경로를 구성하는 요소는 디렉터리일 수도 있고 하드 링크, 심볼릭 링크, 일반 파일일 수도 있다. 경로의 종류로는 절대 경로, 표준 경로, 상대 경로가 있다.
    - `절대 경로` : 파일을 가리키는 고유한 경로값
    - `표준 경로` : 심볼릭 링크나 (현재 디렉터리를 가리키는 '.'나 부모 디렉터리를 가리키는 '..'와 같은) 상대경로가 아닌 경로
    - `상대 경로` : 파일 시스템상의 현재 위치를 기준으로 표현한 경로. 현재 디렉터리를 가리키는 '.'나 부모 디렉터리를 가리키는 '..' 또는 'home/rainer' 등이 모두 상대 경로다. 유닉스에서 상대 경로는 루트 디렉터리(/)로 시작하지 않는다.

### 클래스

- 파일 시스템에 관련된 다양한 클래스

---

|            클래스            |                                        설명                                        |
| :--------------------------: | :--------------------------------------------------------------------------------: |
|             path             |                                  경로를 표현한다.                                  |
|       filesystem_error       |                            익셉션 오브젝트를 정의한다.                             |
|       directory_entry        |                             디렉터리 요소를 표현한다.                              |
|      directory_iterator      |                            디렉터리 반복자를 정의한다.                             |
| recursive_directory_iterator |                         재귀적 디렉터리 반복자를 정의한다.                         |
|         file_status          |                            파일에 대한 정보를 저장한다.                            |
|          space_info          |                            파일 시스템 정보를 표현한다.                            |
|          file_type           |                              파일의 타입을 가리킨다.                               |
|            perms             |                             파일 접근 권한을 표현한다.                             |
|         copy_options         |                 `copy`와 `copy_file` 함수에 대한 옵션을 표현한다.                  |
|      directory_options       | `directory_iterator`와 `recursive_directory_iterator` 함수에 대한 옵션을 표현한다. |
|        file_time_type        |                               파일 시작을 표현한다.                                |

- ### 파일의 접근 권한 조작하기
  - 파일 접근 권한은 `std::filesystem:perms` 클래스로 표현한다. 이 클래스틑 비트마스크 타입이므로 비트 단위 연산으로 조작할 수 있다. 접근 권한은 `POSIX 규격`을 따른다.

### 비멤버 함수

- 파일 시스템을 다루기 위한 비멤버 함수

---

|                비멤버 함수                |                                     설명                                      |
| :---------------------------------------: | :---------------------------------------------------------------------------: |
|                 absolute                  |                             절대 경로를 구성한다.                             |
|        canoical과 weakly_canonical        |                             표준 경로를 구성한다.                             |
|           relative와 proximate            |                             상대 경로를 구성한다.                             |
|                   copy                    |                          파일과 디렉터리를 복제한다.                          |
|                 copy_file                 |                             파일 내용을 복제한다.                             |
|               copy_symlink                |                            심볼릭 링크를 복제한다.                            |
|   create_directory와 create_directories   |                            새 디렉터리를 생성한다.                            |
|             create_hard_link              |                             하드 링크를 생성한다.                             |
| create_symlink와 create_directory_symlink |                            심볼릭 링크를 생성한다.                            |
|               current_path                |                        현재 작업 디렉터리로 돌아간다.                         |
|                  exists                   |                   주어진 경로의 파일이 존재하는지 검사한다.                   |
|                equivalent                 |                  두 경로가 같은 파일을 가리키는지 검사한다.                   |
|                 file_size                 |                             파일 크기를 리턴한다.                             |
|              hard_link_count              |                    파일에 걸린 하드 링크 개수를 리턴한다.                     |
|              last_write_time              |             가장 최근에 파일을 수정한 시각을 알아내거나 설정한다.             |
|                permissions                |                          파일 접근 권한을 변경한다.                           |
|               read_symlink                |                        심볼릭 링크의 타깃을 알아낸다.                         |
|                  remove                   |                       파일 또는 빈 디렉터리를 삭제한다.                       |
|                remove_all                 | 파일 또는 디렉터리를 삭제한다. 디렉터리 안에 담긴 내용은 재귀적으로 삭제한다. |
|                  rename                   |                 파일이나 디렉터리 이름 또는 위치를 변경한다.                  |
|                resize_file                |                  잘라내기(tuncation)로 파일 크기를 변경한다.                  |
|                   space                   |                      파일 시스템에서 빈 공간을 리턴한다.                      |
|                  status                   |                             파일 속성을 결정한다.                             |
|              symlink_status               |              파일 속성을 결정하고 심볼릭 링크의 타깃을 검사한다.              |
|            temp_directory_path            |                     임시 파일을 위한 디렉터리를 리턴한다.                     |

- ### 파일을 마지막으로 쓴 시각을 읽거나 설정하기

  - 글로벌 함수인 `std::filesystem::last_write_time`을 이용하면 파일을 마지막으로 쓴 시각을 읽거나 설정할 수 있다.

- ### 파일 시스템 공간 정보 알아내기
  - 글로벌 함수인 `std::filesystem::space`는 `std::filesystem::space_info` 타입 오브젝트를 리턴한다. 이 오브젝트는 `capacity`, `free`, `available`이란 맴버를 갖고 있다.
    - `capacity` : 파일 시스템 전체 크기
    - `free` : 파일 시스템에서 빈 공간
    - `available` : 일반 프로세스가 사용할 수 있는 빈 공간(free가 가리키는 공간과 같거나 그보다 작다.)

### 파일 타입

- 파일 시스템의 파일 타입

---

|     파일 타입     |                         설명                         |
| :---------------: | :--------------------------------------------------: |
|   is_block_file   |    주어진 경로가 블록 파일을 가리키는지 검사한다.    |
| is_character_file |    주어진 경로가 문자 파일을 가리키는지 검사한다.    |
|   is_directory    |    주어진 경로가 디렉터리를 가리키는지 검사한다.     |
|     is_empty      | 주어진 경로가 빈 파일 또는 빈 디렉터리인지 검사한다. |
|      is_fifo      |     주어진 경로가 `네임드 파이프`인지 검사한다.      |
|     is_other      |    주어진 경로가 다른 파일을 가리키는지 검사한다.    |
|  is_regular_file  |    주어진 경로가 일반 파일을 가리키는지 검사한다.    |
|     is_socket     |    주어진 경로가 IPC 소켓을 가리키는지 검사한다.     |
|    is_symlink     |   주어진 경로가 심볼릭 링크를 가리키는지 검사한다.   |
|   status_known    |      주어진 파일에 상태가 설정됐는지 검사한다.       |

- ### 파일 타입 알아내기
  - 프레디케이트를 이용하면 파일의 타입에 대한 정보를 알아낼 수 있으며, 한 파일에 여러 프레디케이트를 사용해야 할 수도 있다.
